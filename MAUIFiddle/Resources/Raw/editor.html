<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<style>
		html, body, #container {
			height: 100%;
			margin: 0;
			padding: 0;
			overflow: hidden;
		}
	</style>
</head>
<body>
	<div id="container"></div>

	<script src="./vs/loader.js"></script>
	<script>
		require.config({ paths: { vs: './vs' } });
		require(["vs/editor/editor.main"], function () {
			window.editor = monaco.editor.create(document.getElementById("container"), {
				language: "csharp",
				theme: "vs-dark",
				automaticLayout: true,
				folding: true,
				minimap: {
					enabled: true
				},
				lineNumbers: "on"
			});

			// Listen to changes
			window.editor.onDidChangeModelContent(function (event) {
				const text = window.editor.getValue();
				const content = encodeURIComponent(text);
				window.location = "callback://editor?text=" + content;
			});

			// Make accessible from MAUI
			window.setEditorText = function (text) {
				//alert(text);
				if (window.editor) {
					var decoded = decodeURIComponent(text);
					decoded = decoded.replace(/\+/g, " ");
					window.editor.setValue(decoded);
				}
			};

			window.getEditorText = () => {
				return window.editor.getValue();
			};

			window.setEditorFontSize = function (size) {
				if (window.editor) {
					window.editor.updateOptions({ fontSize: size });
				}
			};

			/*
			// Listen to changes
			window.editor.onDidChangeModelContent(function (event) {
				const text = window.editor.getValue();
				console.log("Editor content changed:", text);

				// Optionally, send to .NET MAUI
				if (window.externalNotify) {
					window.externalNotify(text);
				}
			});
			*/

			/*
			window.editor.setValue([
				"using System;",
				"",
				"namespace HelloWorld",
				"{",
				"    class Program",
				"    {",
				"        static void Main(string[] args)",
				"        {",
				"            Console.WriteLine(\"Hello World!\");",
				"        }",
				"    }",
				"}"
			].join("\n"));
			*/

			//window.editor.focus();

			window.location = "callback://editor?status=done";
		});
	</script>
</body>
</html>
